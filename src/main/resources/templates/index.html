<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">

<head th:replace="fragments/common :: head">
</head>

<body>
    <div th:replace="fragments/common :: headermain"></div>

    <div id="container" align="center">
    
    <div id="posts" align="center">    
        <a href="/index">
            <img border="0" class="center" src="../static/images/Quacks.png" th:src="@{/images/Quacks.png}" style="width:400px; height:400">
        </a>

        <form id="post-quack-form" th:action="@{/quack}" enctype="multipart/form-data" method="post">
            <div>
                <label for="message">Message</label>: <input type="text" name="message" id="message"/>
                <input type="submit" value="Submit"/>
            </div>
            <div>
                <input type="file" id="quack-attachment"
                       name="file" aria-describedby="inputGroupFileAddon01">
            </div>
        </form>

        <h2><a href="/users">List users</a></h2>
    </div>   
    
    

    
    
    <div id="latestQuacks" align="center">
        <a href="/index">
            <img border="0" class="center" src="../static/images/LatestQuacks.png" th:src="@{/images/LatestQuacks.png}" style="width:600px; height:600">
        </a>
        
        
       <div id="myDIV" class="feedFilterMain">
             <button class="feedFilter active">
          <p> All users </p>
      </button>
            <button class="feedFilter">
          <p> Followed users </p>
      </button>
      </div>
      
      <script>
var header = document.getElementById("myDIV");
var btns = header.getElementsByClassName("feedFilter");
for (var i = 0; i < btns.length; i++) {
  btns[i].addEventListener("click", function() {
  var current = document.getElementsByClassName("active");
  current[0].className = current[0].className.replace(" active", "");
  this.className += " active";
  });
}
</script>


        
        <div th:each="quack : ${quacks}" class="postaus">        
                  <img border="0" alt="oma profiilikuva" class="rounded-circle border border-dark" 
  src="${profilePhotoUrl}" th:src="@{/images/quackerhar.png}" 
  style="width:60px; height:40px ">
  
  
              <b><span th:text="${quack.poster.getName()}">poster</span></b>:
                
                <div class="quacki">
                <span th:text="${quack.getQuackMessage()}">message</span>
                </div>
                
                <div class="oikea">
                <span th:text="${quack.getFormattedDate()}">dateposted
                </span>
                 <a  th:href="@{'/like/' + ${quack.getId()}}" class="btn btn-primary fa fa-thumbs-up"  ></a>
               </div> 
               
             <div th:if="${quack.getLikers().contains(loggedUser)}">
                <a th:href="@{'/like/' + ${quack.getId()}}" class="btn btn-primary">Unlike</a>
            </div>
            <div th:unless="${quack.getLikers().contains(loggedUser)}">
                <a th:href="@{'/like/' + ${quack.getId()}}" class="btn btn-primary">Like</a>
            </div>
        </div>
        
        
        
        
    </div>    
        

</div>

<script>
    /**
     * Lisää esikatselukuva jos tiedosto on jokin kuvaformaatti
     */
    document.querySelector("#quack-attachment").addEventListener('change', function () {
        if (this.files && this.files[0] && this.files[0].type.includes('image')) {
            const image = new Image()
            const objectURL = URL.createObjectURL(this.files[0])
            image.onload = () => {
                document.querySelector("#post-quack-form").prepend(image)
                URL.revokeObjectURL(objectURL)
            }
            image.src = objectURL
        }
    })
</script>
</body>
</html>